<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>ApoTakeCare - Products Page</title>
	<link rel="stylesheet" href="/pico.jade.min.css">
	<link rel="stylesheet" href="/general.css">
	<link rel="stylesheet" href="/ShowProductModalStyle.css">
	<script type="text/javascript" src="/showModal.js" defer></script>
</head>
<body>
<main class="container">
	
	<!-- Header : -->	
	<div th:replace="frag :: header"></div>
	
	<h1>All our marvelous product :</h1>	
	<h5>(Click on a row)</h5>
	<button>Add a new Product</button>	
	 
	
	<!--  Show all Products :  -->
	<table>		
		<thead>
		    <tr>
		        <th><a th:href="@{/products(sort='id', order=${param.sort == null or param.sort[0] != 'id' or param.order[0] != 'asc' ? 'asc' : 'desc'})}">
		        	ID
		            </a></th>
		        <th><a th:href="@{/products(sort='name', order=${param.sort == null or param.sort[0] != 'name' or param.order[0] != 'asc' ? 'asc' : 'desc'})}">
		        	Product Name
		            </a></th>
		        <th>Other Name(s)</th>
		        <th>Description</th>
		        <th><a th:href="@{/products(sort='shelfNumber', order=${param.sort == null or param.sort[0] != 'shelfNumber' or param.order[0] != 'asc' ? 'asc' : 'desc'})}">
		        	Shelf Number
		            </a></th>
		    </tr>
		</thead>


    	<tbody>
			<tr id="aProductRow" th:each="product : ${products}" 
			    th:onclick="|window.location.href='/products/' + '${product.id}'|">
			    <td th:text="${product.id}">(ID)</td>
			    <td th:text="${product.name}">(NAME)</td>
			    <td>
			        <ul>
			            <li th:each="item : ${product.otherNames}" th:text="${item}">(OTHER NAMES)</li>
			        </ul>
			    </td>
			    <td th:text="${product.description}">(DESCRIPT)</td>
			    <td th:text="${product.stock != null ? product.stock.shelfNumber : ''}">(ShelfNumber)</td>
			</tr>

    	</tbody>		
	</table>
	
	
	
	
	<!-- Show One Product : -->
	
	<div class="modalBackground" th:if="${selectedProduct}" onclick="window.location.href='/products'"></div>

	<div class="productModal" th:if="${selectedProduct}">
	    <span class="close-button" onclick="window.location.href='/products'">
	        <img src="/img/closeIcon.png">
	    </span>
	
	    <div class="productModal_Content">
	        <img th:src="${selectedProduct.type.name() == 'PLANT' ? '/img/plant.png' :
	                     selectedProduct.type.name() == 'WOOD' ? '/img/wood.png' :
	                     selectedProduct.type.name() == 'FUNGUS' ? '/img/fungus.png' :
	                     selectedProduct.type.name() == 'ANIMAL_PART' ? '/img/insect.png' : '/img/other.png'}"
	             class="ProductTypeIcon"
	             th:title="${selectedProduct.type}">
	
	        <h3>
	            <span th:text="${selectedProduct.id}">Id</span> | <span th:text="${selectedProduct.name}">Product Name</span>
	        </h3>        
			
			
	        <h5 th:text="${#strings.arrayJoin(selectedProduct.otherNames.toArray(), ', ')}"></h5>
	        <img class="modalImage" th:src="${selectedProduct.picLink}">
	        <p><strong>Description: </strong> <span th:text="${selectedProduct.description}"></span></p>
			
			
			
			<!-- Liaison STOCK : -->
	        <hr>
	        <div>
	        	<p>
	        		<strong>Shelf: </strong><span th:text="${selectedProduct.stock != null ? 'nÂ° ' + selectedProduct.stock.shelfNumber : 'Unavailable'}"></span>
	        	</p>
	        	<p th:if="${selectedProduct.stock != null && selectedProduct.stock.dosage != null }">
	        		<strong>Quantity : </strong><span th:text="${selectedProduct.stock.dosage.quantity + ' ' + selectedProduct.stock.dosage.unit}"></span>
	        		 | 
	        		 <strong>Price : </strong><span th:text="${selectedProduct.stock.pricePerUnit + ' $ / ' + selectedProduct.stock.dosage.unit}"></span>
	        	</p>
	            
	        </div>
	        
	        
	        <!-- Liaison(s) EFFECT AND PREP : -->
	        <hr>
	        <div>
	        	<h6>Effect(s) and Preparation(s) :</h6>
	        	<div class="anEffect_Modal" th:each="item : ${selectedProduct.possibleEffectsAnfPreparations}">
	        		<h5 th:text="${item.categoryOfThisEffect != null ? item.categoryOfThisEffect.title : 'An effect : '}" ></h5>
	        		<p><strong>Effect : </strong><span th:text="${item.effectDescription}"></span></p>
	        		<p><strong>Preparation : </strong><span th:text="${item.preparationDescription}"></span></p>
	        	</div>	          
	        </div>
	    </div>
	</div>
	
	<!-- FOOTER -->
	<div th:replace="frag :: footer"></div>
</main>
</body>
</html>